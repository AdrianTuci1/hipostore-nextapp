"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "sanitizeQueryValue", {
    enumerable: true,
    get: function() {
        return sanitizeQueryValue;
    }
});
const _mongoose = /*#__PURE__*/ _interop_require_default(require("mongoose"));
const _utilities = require("payload/utilities");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const sanitizeQueryValue = ({ field, hasCustomID, operator, path, val })=>{
    let formattedValue = val;
    let formattedOperator = operator;
    // Disregard invalid _ids
    if (path === '_id' && typeof val === 'string' && val.split(',').length === 1) {
        if (!hasCustomID) {
            const isValid = _mongoose.default.Types.ObjectId.isValid(val);
            if (!isValid) {
                return {
                    operator: formattedOperator,
                    val: undefined
                };
            }
        }
        if (field.type === 'number') {
            const parsedNumber = parseFloat(val);
            if (Number.isNaN(parsedNumber)) {
                return {
                    operator: formattedOperator,
                    val: undefined
                };
            }
        }
    }
    // Cast incoming values as proper searchable types
    if (field.type === 'checkbox' && typeof val === 'string') {
        if (val.toLowerCase() === 'true') formattedValue = true;
        if (val.toLowerCase() === 'false') formattedValue = false;
    }
    if ([
        'all',
        'in',
        'not_in'
    ].includes(operator) && typeof formattedValue === 'string') {
        formattedValue = (0, _utilities.createArrayFromCommaDelineated)(formattedValue);
        if (field.type === 'number') {
            formattedValue = formattedValue.map((arrayVal)=>parseFloat(arrayVal));
        }
    }
    if (field.type === 'number' && typeof formattedValue === 'string') {
        formattedValue = Number(val);
    }
    if (field.type === 'date' && typeof val === 'string' && operator !== 'exists') {
        formattedValue = new Date(val);
        if (Number.isNaN(Date.parse(formattedValue))) {
            return undefined;
        }
    }
    if ([
        'relationship',
        'upload'
    ].includes(field.type)) {
        if (val === 'null') {
            formattedValue = null;
        }
        // Object equality requires the value to be the first key in the object that is being queried.
        if (operator === 'equals' && formattedValue && typeof formattedValue === 'object' && formattedValue.value && formattedValue.relationTo) {
            return {
                rawQuery: {
                    $and: [
                        {
                            [`${path}.value`]: {
                                $eq: formattedValue.value
                            }
                        },
                        {
                            [`${path}.relationTo`]: {
                                $eq: formattedValue.relationTo
                            }
                        }
                    ]
                }
            };
        }
        if (operator === 'in' && Array.isArray(formattedValue)) {
            formattedValue = formattedValue.reduce((formattedValues, inVal)=>{
                const newValues = [
                    inVal
                ];
                if (_mongoose.default.Types.ObjectId.isValid(inVal)) newValues.push(new _mongoose.default.Types.ObjectId(inVal));
                const parsedNumber = parseFloat(inVal);
                if (!Number.isNaN(parsedNumber)) newValues.push(parsedNumber);
                return [
                    ...formattedValues,
                    ...newValues
                ];
            }, []);
        }
    }
    // Set up specific formatting necessary by operators
    if (operator === 'near') {
        let lng;
        let lat;
        let maxDistance;
        let minDistance;
        if (Array.isArray(formattedValue)) {
            [lng, lat, maxDistance, minDistance] = formattedValue;
        }
        if (typeof formattedValue === 'string') {
            [lng, lat, maxDistance, minDistance] = (0, _utilities.createArrayFromCommaDelineated)(formattedValue);
        }
        if (lng == null || lat == null || maxDistance == null && minDistance == null) {
            formattedValue = undefined;
        } else {
            formattedValue = {
                $geometry: {
                    type: 'Point',
                    coordinates: [
                        parseFloat(lng),
                        parseFloat(lat)
                    ]
                }
            };
            if (maxDistance) formattedValue.$maxDistance = parseFloat(maxDistance);
            if (minDistance) formattedValue.$minDistance = parseFloat(minDistance);
        }
    }
    if (operator === 'within' || operator === 'intersects') {
        formattedValue = {
            $geometry: formattedValue
        };
    }
    if (path !== '_id' || path === '_id' && hasCustomID && field.type === 'text') {
        if (operator === 'contains') {
            formattedValue = {
                $options: 'i',
                $regex: formattedValue
            };
        }
    }
    if ((path === '_id' || path === 'parent') && operator === 'like' && formattedValue.length === 24 && !hasCustomID) {
        formattedOperator = 'equals';
    }
    if (operator === 'exists') {
        formattedValue = formattedValue === 'true' || formattedValue === true;
        // Clearable fields
        if ([
            'relationship',
            'select',
            'upload'
        ].includes(field.type)) {
            if (formattedValue) {
                return {
                    rawQuery: {
                        $and: [
                            {
                                [path]: {
                                    $exists: true
                                }
                            },
                            {
                                [path]: {
                                    $ne: null
                                }
                            }
                        ]
                    }
                };
            } else {
                return {
                    rawQuery: {
                        $or: [
                            {
                                [path]: {
                                    $exists: false
                                }
                            },
                            {
                                [path]: {
                                    $eq: null
                                }
                            }
                        ]
                    }
                };
            }
        }
    }
    return {
        operator: formattedOperator,
        val: formattedValue
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9xdWVyaWVzL3Nhbml0aXplUXVlcnlWYWx1ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEZpZWxkLCBUYWJBc0ZpZWxkIH0gZnJvbSAncGF5bG9hZC90eXBlcydcblxuaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJ1xuaW1wb3J0IHsgY3JlYXRlQXJyYXlGcm9tQ29tbWFEZWxpbmVhdGVkIH0gZnJvbSAncGF5bG9hZC91dGlsaXRpZXMnXG5cbnR5cGUgU2FuaXRpemVRdWVyeVZhbHVlQXJncyA9IHtcbiAgZmllbGQ6IEZpZWxkIHwgVGFiQXNGaWVsZFxuICBoYXNDdXN0b21JRDogYm9vbGVhblxuICBvcGVyYXRvcjogc3RyaW5nXG4gIHBhdGg6IHN0cmluZ1xuICB2YWw6IGFueVxufVxuXG5leHBvcnQgY29uc3Qgc2FuaXRpemVRdWVyeVZhbHVlID0gKHtcbiAgZmllbGQsXG4gIGhhc0N1c3RvbUlELFxuICBvcGVyYXRvcixcbiAgcGF0aCxcbiAgdmFsLFxufTogU2FuaXRpemVRdWVyeVZhbHVlQXJncyk6IHtcbiAgb3BlcmF0b3I/OiBzdHJpbmdcbiAgcmF3UXVlcnk/OiB1bmtub3duXG4gIHZhbD86IHVua25vd25cbn0gPT4ge1xuICBsZXQgZm9ybWF0dGVkVmFsdWUgPSB2YWxcbiAgbGV0IGZvcm1hdHRlZE9wZXJhdG9yID0gb3BlcmF0b3JcblxuICAvLyBEaXNyZWdhcmQgaW52YWxpZCBfaWRzXG4gIGlmIChwYXRoID09PSAnX2lkJyAmJiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyAmJiB2YWwuc3BsaXQoJywnKS5sZW5ndGggPT09IDEpIHtcbiAgICBpZiAoIWhhc0N1c3RvbUlEKSB7XG4gICAgICBjb25zdCBpc1ZhbGlkID0gbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQuaXNWYWxpZCh2YWwpXG5cbiAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICByZXR1cm4geyBvcGVyYXRvcjogZm9ybWF0dGVkT3BlcmF0b3IsIHZhbDogdW5kZWZpbmVkIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZmllbGQudHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnN0IHBhcnNlZE51bWJlciA9IHBhcnNlRmxvYXQodmFsKVxuXG4gICAgICBpZiAoTnVtYmVyLmlzTmFOKHBhcnNlZE51bWJlcikpIHtcbiAgICAgICAgcmV0dXJuIHsgb3BlcmF0b3I6IGZvcm1hdHRlZE9wZXJhdG9yLCB2YWw6IHVuZGVmaW5lZCB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ2FzdCBpbmNvbWluZyB2YWx1ZXMgYXMgcHJvcGVyIHNlYXJjaGFibGUgdHlwZXNcbiAgaWYgKGZpZWxkLnR5cGUgPT09ICdjaGVja2JveCcgJiYgdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAodmFsLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJykgZm9ybWF0dGVkVmFsdWUgPSB0cnVlXG4gICAgaWYgKHZhbC50b0xvd2VyQ2FzZSgpID09PSAnZmFsc2UnKSBmb3JtYXR0ZWRWYWx1ZSA9IGZhbHNlXG4gIH1cblxuICBpZiAoWydhbGwnLCAnaW4nLCAnbm90X2luJ10uaW5jbHVkZXMob3BlcmF0b3IpICYmIHR5cGVvZiBmb3JtYXR0ZWRWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBmb3JtYXR0ZWRWYWx1ZSA9IGNyZWF0ZUFycmF5RnJvbUNvbW1hRGVsaW5lYXRlZChmb3JtYXR0ZWRWYWx1ZSlcblxuICAgIGlmIChmaWVsZC50eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSBmb3JtYXR0ZWRWYWx1ZS5tYXAoKGFycmF5VmFsKSA9PiBwYXJzZUZsb2F0KGFycmF5VmFsKSlcbiAgICB9XG4gIH1cblxuICBpZiAoZmllbGQudHlwZSA9PT0gJ251bWJlcicgJiYgdHlwZW9mIGZvcm1hdHRlZFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIGZvcm1hdHRlZFZhbHVlID0gTnVtYmVyKHZhbClcbiAgfVxuXG4gIGlmIChmaWVsZC50eXBlID09PSAnZGF0ZScgJiYgdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgJiYgb3BlcmF0b3IgIT09ICdleGlzdHMnKSB7XG4gICAgZm9ybWF0dGVkVmFsdWUgPSBuZXcgRGF0ZSh2YWwpXG4gICAgaWYgKE51bWJlci5pc05hTihEYXRlLnBhcnNlKGZvcm1hdHRlZFZhbHVlKSkpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWRcbiAgICB9XG4gIH1cblxuICBpZiAoWydyZWxhdGlvbnNoaXAnLCAndXBsb2FkJ10uaW5jbHVkZXMoZmllbGQudHlwZSkpIHtcbiAgICBpZiAodmFsID09PSAnbnVsbCcpIHtcbiAgICAgIGZvcm1hdHRlZFZhbHVlID0gbnVsbFxuICAgIH1cblxuICAgIC8vIE9iamVjdCBlcXVhbGl0eSByZXF1aXJlcyB0aGUgdmFsdWUgdG8gYmUgdGhlIGZpcnN0IGtleSBpbiB0aGUgb2JqZWN0IHRoYXQgaXMgYmVpbmcgcXVlcmllZC5cbiAgICBpZiAoXG4gICAgICBvcGVyYXRvciA9PT0gJ2VxdWFscycgJiZcbiAgICAgIGZvcm1hdHRlZFZhbHVlICYmXG4gICAgICB0eXBlb2YgZm9ybWF0dGVkVmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgICBmb3JtYXR0ZWRWYWx1ZS52YWx1ZSAmJlxuICAgICAgZm9ybWF0dGVkVmFsdWUucmVsYXRpb25Ub1xuICAgICkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmF3UXVlcnk6IHtcbiAgICAgICAgICAkYW5kOiBbXG4gICAgICAgICAgICB7IFtgJHtwYXRofS52YWx1ZWBdOiB7ICRlcTogZm9ybWF0dGVkVmFsdWUudmFsdWUgfSB9LFxuICAgICAgICAgICAgeyBbYCR7cGF0aH0ucmVsYXRpb25Ub2BdOiB7ICRlcTogZm9ybWF0dGVkVmFsdWUucmVsYXRpb25UbyB9IH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob3BlcmF0b3IgPT09ICdpbicgJiYgQXJyYXkuaXNBcnJheShmb3JtYXR0ZWRWYWx1ZSkpIHtcbiAgICAgIGZvcm1hdHRlZFZhbHVlID0gZm9ybWF0dGVkVmFsdWUucmVkdWNlKChmb3JtYXR0ZWRWYWx1ZXMsIGluVmFsKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlcyA9IFtpblZhbF1cbiAgICAgICAgaWYgKG1vbmdvb3NlLlR5cGVzLk9iamVjdElkLmlzVmFsaWQoaW5WYWwpKVxuICAgICAgICAgIG5ld1ZhbHVlcy5wdXNoKG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChpblZhbCkpXG5cbiAgICAgICAgY29uc3QgcGFyc2VkTnVtYmVyID0gcGFyc2VGbG9hdChpblZhbClcbiAgICAgICAgaWYgKCFOdW1iZXIuaXNOYU4ocGFyc2VkTnVtYmVyKSkgbmV3VmFsdWVzLnB1c2gocGFyc2VkTnVtYmVyKVxuXG4gICAgICAgIHJldHVybiBbLi4uZm9ybWF0dGVkVmFsdWVzLCAuLi5uZXdWYWx1ZXNdXG4gICAgICB9LCBbXSlcbiAgICB9XG4gIH1cblxuICAvLyBTZXQgdXAgc3BlY2lmaWMgZm9ybWF0dGluZyBuZWNlc3NhcnkgYnkgb3BlcmF0b3JzXG5cbiAgaWYgKG9wZXJhdG9yID09PSAnbmVhcicpIHtcbiAgICBsZXQgbG5nXG4gICAgbGV0IGxhdFxuICAgIGxldCBtYXhEaXN0YW5jZVxuICAgIGxldCBtaW5EaXN0YW5jZVxuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZm9ybWF0dGVkVmFsdWUpKSB7XG4gICAgICA7W2xuZywgbGF0LCBtYXhEaXN0YW5jZSwgbWluRGlzdGFuY2VdID0gZm9ybWF0dGVkVmFsdWVcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGZvcm1hdHRlZFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgO1tsbmcsIGxhdCwgbWF4RGlzdGFuY2UsIG1pbkRpc3RhbmNlXSA9IGNyZWF0ZUFycmF5RnJvbUNvbW1hRGVsaW5lYXRlZChmb3JtYXR0ZWRWYWx1ZSlcbiAgICB9XG5cbiAgICBpZiAobG5nID09IG51bGwgfHwgbGF0ID09IG51bGwgfHwgKG1heERpc3RhbmNlID09IG51bGwgJiYgbWluRGlzdGFuY2UgPT0gbnVsbCkpIHtcbiAgICAgIGZvcm1hdHRlZFZhbHVlID0gdW5kZWZpbmVkXG4gICAgfSBlbHNlIHtcbiAgICAgIGZvcm1hdHRlZFZhbHVlID0ge1xuICAgICAgICAkZ2VvbWV0cnk6IHsgdHlwZTogJ1BvaW50JywgY29vcmRpbmF0ZXM6IFtwYXJzZUZsb2F0KGxuZyksIHBhcnNlRmxvYXQobGF0KV0gfSxcbiAgICAgIH1cblxuICAgICAgaWYgKG1heERpc3RhbmNlKSBmb3JtYXR0ZWRWYWx1ZS4kbWF4RGlzdGFuY2UgPSBwYXJzZUZsb2F0KG1heERpc3RhbmNlKVxuICAgICAgaWYgKG1pbkRpc3RhbmNlKSBmb3JtYXR0ZWRWYWx1ZS4kbWluRGlzdGFuY2UgPSBwYXJzZUZsb2F0KG1pbkRpc3RhbmNlKVxuICAgIH1cbiAgfVxuXG4gIGlmIChvcGVyYXRvciA9PT0gJ3dpdGhpbicgfHwgb3BlcmF0b3IgPT09ICdpbnRlcnNlY3RzJykge1xuICAgIGZvcm1hdHRlZFZhbHVlID0ge1xuICAgICAgJGdlb21ldHJ5OiBmb3JtYXR0ZWRWYWx1ZSxcbiAgICB9XG4gIH1cblxuICBpZiAocGF0aCAhPT0gJ19pZCcgfHwgKHBhdGggPT09ICdfaWQnICYmIGhhc0N1c3RvbUlEICYmIGZpZWxkLnR5cGUgPT09ICd0ZXh0JykpIHtcbiAgICBpZiAob3BlcmF0b3IgPT09ICdjb250YWlucycpIHtcbiAgICAgIGZvcm1hdHRlZFZhbHVlID0geyAkb3B0aW9uczogJ2knLCAkcmVnZXg6IGZvcm1hdHRlZFZhbHVlIH1cbiAgICB9XG4gIH1cblxuICBpZiAoXG4gICAgKHBhdGggPT09ICdfaWQnIHx8IHBhdGggPT09ICdwYXJlbnQnKSAmJlxuICAgIG9wZXJhdG9yID09PSAnbGlrZScgJiZcbiAgICBmb3JtYXR0ZWRWYWx1ZS5sZW5ndGggPT09IDI0ICYmXG4gICAgIWhhc0N1c3RvbUlEXG4gICkge1xuICAgIGZvcm1hdHRlZE9wZXJhdG9yID0gJ2VxdWFscydcbiAgfVxuXG4gIGlmIChvcGVyYXRvciA9PT0gJ2V4aXN0cycpIHtcbiAgICBmb3JtYXR0ZWRWYWx1ZSA9IGZvcm1hdHRlZFZhbHVlID09PSAndHJ1ZScgfHwgZm9ybWF0dGVkVmFsdWUgPT09IHRydWVcblxuICAgIC8vIENsZWFyYWJsZSBmaWVsZHNcbiAgICBpZiAoWydyZWxhdGlvbnNoaXAnLCAnc2VsZWN0JywgJ3VwbG9hZCddLmluY2x1ZGVzKGZpZWxkLnR5cGUpKSB7XG4gICAgICBpZiAoZm9ybWF0dGVkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByYXdRdWVyeToge1xuICAgICAgICAgICAgJGFuZDogW3sgW3BhdGhdOiB7ICRleGlzdHM6IHRydWUgfSB9LCB7IFtwYXRoXTogeyAkbmU6IG51bGwgfSB9XSxcbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJhd1F1ZXJ5OiB7XG4gICAgICAgICAgICAkb3I6IFt7IFtwYXRoXTogeyAkZXhpc3RzOiBmYWxzZSB9IH0sIHsgW3BhdGhdOiB7ICRlcTogbnVsbCB9IH1dLFxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBvcGVyYXRvcjogZm9ybWF0dGVkT3BlcmF0b3IsIHZhbDogZm9ybWF0dGVkVmFsdWUgfVxufVxuIl0sIm5hbWVzIjpbInNhbml0aXplUXVlcnlWYWx1ZSIsImZpZWxkIiwiaGFzQ3VzdG9tSUQiLCJvcGVyYXRvciIsInBhdGgiLCJ2YWwiLCJmb3JtYXR0ZWRWYWx1ZSIsImZvcm1hdHRlZE9wZXJhdG9yIiwic3BsaXQiLCJsZW5ndGgiLCJpc1ZhbGlkIiwibW9uZ29vc2UiLCJUeXBlcyIsIk9iamVjdElkIiwidW5kZWZpbmVkIiwidHlwZSIsInBhcnNlZE51bWJlciIsInBhcnNlRmxvYXQiLCJOdW1iZXIiLCJpc05hTiIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJjcmVhdGVBcnJheUZyb21Db21tYURlbGluZWF0ZWQiLCJtYXAiLCJhcnJheVZhbCIsIkRhdGUiLCJwYXJzZSIsInZhbHVlIiwicmVsYXRpb25UbyIsInJhd1F1ZXJ5IiwiJGFuZCIsIiRlcSIsIkFycmF5IiwiaXNBcnJheSIsInJlZHVjZSIsImZvcm1hdHRlZFZhbHVlcyIsImluVmFsIiwibmV3VmFsdWVzIiwicHVzaCIsImxuZyIsImxhdCIsIm1heERpc3RhbmNlIiwibWluRGlzdGFuY2UiLCIkZ2VvbWV0cnkiLCJjb29yZGluYXRlcyIsIiRtYXhEaXN0YW5jZSIsIiRtaW5EaXN0YW5jZSIsIiRvcHRpb25zIiwiJHJlZ2V4IiwiJGV4aXN0cyIsIiRuZSIsIiRvciJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFhYUE7OztlQUFBQTs7O2lFQVhROzJCQUMwQjs7Ozs7O0FBVXhDLE1BQU1BLHFCQUFxQixDQUFDLEVBQ2pDQyxLQUFLLEVBQ0xDLFdBQVcsRUFDWEMsUUFBUSxFQUNSQyxJQUFJLEVBQ0pDLEdBQUcsRUFDb0I7SUFLdkIsSUFBSUMsaUJBQWlCRDtJQUNyQixJQUFJRSxvQkFBb0JKO0lBRXhCLHlCQUF5QjtJQUN6QixJQUFJQyxTQUFTLFNBQVMsT0FBT0MsUUFBUSxZQUFZQSxJQUFJRyxLQUFLLENBQUMsS0FBS0MsTUFBTSxLQUFLLEdBQUc7UUFDNUUsSUFBSSxDQUFDUCxhQUFhO1lBQ2hCLE1BQU1RLFVBQVVDLGlCQUFRLENBQUNDLEtBQUssQ0FBQ0MsUUFBUSxDQUFDSCxPQUFPLENBQUNMO1lBRWhELElBQUksQ0FBQ0ssU0FBUztnQkFDWixPQUFPO29CQUFFUCxVQUFVSTtvQkFBbUJGLEtBQUtTO2dCQUFVO1lBQ3ZEO1FBQ0Y7UUFFQSxJQUFJYixNQUFNYyxJQUFJLEtBQUssVUFBVTtZQUMzQixNQUFNQyxlQUFlQyxXQUFXWjtZQUVoQyxJQUFJYSxPQUFPQyxLQUFLLENBQUNILGVBQWU7Z0JBQzlCLE9BQU87b0JBQUViLFVBQVVJO29CQUFtQkYsS0FB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